/**
	PowerTools
	authors: Christoph Pojer (@cpojer)
	license: MIT-style license.
*/
(function(){[Element,Window,Document].invoke("implement",{hasEvent:function(g){var f=this.retrieve("events"),h=(f&&f[g])?f[g].values:null;if(h){for(var e=h.length;e--;){if(e in h){return true}}}return false}});var d=function(g,h,e,f){h=g[h];e=g[e];return function(i,j){if(!j){j=f}if(e&&!this.hasEvent(j)){e.call(this,i,j)}if(h){h.call(this,i,j)}}};var b=function(g,f,h,e){return function(i,j){f[h].call(this,i,j||e);g[h].call(this,i,j||e)}};var c=Element.Events;Element.defineCustomEvent=function(e,g){var f=c[g.base];g.onAdd=d(g,"onAdd","onSetup",e);g.onRemove=d(g,"onRemove","onTeardown",e);c[e]=f?Object.append({},g,{base:f.base,condition:function(h){return(!f.condition||f.condition.call(this,h))&&(!g.condition||g.condition.call(this,h))},onAdd:b(g,f,"onAdd",e),onRemove:b(g,f,"onRemove",e)}):g;return this};var a=function(e){var f="on"+e.capitalize();Element[e+"CustomEvents"]=function(){Object.each(c,function(h,g){if(h[f]){h[f].call(h,g)}})};return a};a("enable")("disable")})();Browser.Features.Touch=(function(){try{document.createEvent("TouchEvent").initTouchEvent("touchstart");return true}catch(a){}return false})();Browser.Features.iOSTouch=(function(){var a="cantouch",c=document.html,f=false;if(!c.addEventListener){return false}var d=function(){c.removeEventListener(a,d,true);f=true};try{c.addEventListener(a,d,true);var e=document.createEvent("TouchEvent");e.initTouchEvent(a);c.dispatchEvent(e);return f}catch(b){}d();return false})();(function(){var a=function(c){if(!c.target||c.target.tagName.toLowerCase()!="select"){c.preventDefault()}};var b;Element.defineCustomEvent("touch",{base:"touchend",condition:function(c){if(b||c.targetTouches.length!=0){return false}var e=c.changedTouches[0],d=document.elementFromPoint(e.clientX,e.clientY);do{if(d==this){return true}}while(d&&(d=d.parentNode));return false},onSetup:function(){this.addEvent("touchstart",a)},onTeardown:function(){this.removeEvent("touchstart",a)},onEnable:function(){b=false},onDisable:function(){b=true}})})();if(Browser.Features.iOSTouch){(function(){var a="click";delete Element.NativeEvents[a];Element.defineCustomEvent(a,{base:"touch"})})()}(function(){var a="swipe",c=a+":distance",f=a+":cancelVertical",g=50;var b={},e,d;var h=function(){d=false};var i={touchstart:function(j){if(j.touches.length>1){return}var k=j.touches[0];d=true;b={x:k.pageX,y:k.pageY}},touchmove:function(l){if(e||!d){return}var p=l.changedTouches[0],j={x:p.pageX,y:p.pageY};if(this.retrieve(f)&&Math.abs(b.y-j.y)>10){d=false;return}var o=this.retrieve(c,g),n=j.x-b.x,m=n<-o,k=n>o;if(!k&&!m){return}l.preventDefault();d=false;l.direction=(m?"left":"right");l.start=b;l.end=j;this.fireEvent(a,l)},touchend:h,touchcancel:h};Element.defineCustomEvent(a,{onSetup:function(){this.addEvents(i)},onTeardown:function(){this.removeEvents(i)},onEnable:function(){e=false},onDisable:function(){e=true;h()}})})();